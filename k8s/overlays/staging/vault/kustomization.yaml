apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

metadata:
  name: vault-staging
  annotations:
    config.kubernetes.io/local-config: "true"

namespace: vault-staging

resources:
  - ../../../base/vault

# Replace placeholders with staging values
replacements:
  - source:
      kind: Namespace
      name: vault-staging
      fieldPath: metadata.name
    targets:
      - select:
          kind: '*'
        fieldPaths:
          - metadata.name
          - metadata.namespace
        options:
          delimiter: 'PLACEHOLDER_OVERLAY'
          index: 1

labels:
  - pairs:
      environment: staging
      app.kubernetes.io/instance: staging