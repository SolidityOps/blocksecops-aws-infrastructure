# External Secrets Operator configuration for Vault staging
# Using ClusterSecretStore for cross-namespace access

apiVersion: external-secrets.io/v1beta1
kind: ClusterSecretStore
metadata:
  name: vault-staging-cluster-secret-store
spec:
  provider:
    vault:
      server: "http://vault.vault-staging.svc.cluster.local:8200"
      path: "secret"
      version: "v2"
      auth:
        kubernetes:
          mountPath: "kubernetes"
          role: "external-secrets-operator"
          serviceAccountRef:
            name: external-secrets-operator
            namespace: external-secrets-staging

---
# Example: External secret for demonstration (not actually used in staging)
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: vault-demo-secret
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: vault-staging-cluster-secret-store
    kind: ClusterSecretStore
  target:
    name: demo-secret
    creationPolicy: Owner
  data:
  - secretKey: demo-key
    remoteRef:
      key: demo/staging
      property: value